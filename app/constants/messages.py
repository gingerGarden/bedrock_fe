"""
플랫폼 전역 메시지 상수 정의 모듈.

이 모듈은 FastAPI(백엔드)와 Streamlit(프론트엔드) 간의 통신 과정,
또는 사용자 입력 검증 단계에서 공통적으로 사용하는
표준화된 메시지(에러·성공·안내문)를 관리한다.

주요 구성
----------
- LoginMsg             : 로그인 관련 메시지
- LoginSelfBlockMsg    : 계정 사용 정지(Soft Delete) 관련 메시지
- LoginSignupMsg       : 회원가입 관련 메시지
- LoginSelfUpdateMsg   : 회원정보 수정 관련 메시지
- AdminMsg             : 관리자 접근 제한 메시지
- MAIN_INTRO           : 초기 메인 페이지 안내문
- NONE_LOGIN_USER      : 미로그인 사용자 안내문
- PERSONAL_INFO_AGREE  : 개인정보 수집·이용 약관 전문
- SOFT_DELETE          : 계정 정지 안내문
"""
from typing import Final



# ============================================================
# 로그인 관련 메시지
# ============================================================
class LoginMsg:

    # --- 공통 통신/예외 ---
    PARSING_JSON_FAIL: Final[str] = "[접속 실패] 응답 JSON 파싱 실패."
    FAIL_UNKNOWN: Final[str] = "[접속 실패] 예상치 못한 응답 형식."

    # --- 성공 ---
    VERIFY_LOGIN_SUCCESS: Final[str] = "[접속 성공] 정상적인 ID와 비밀번호 입력."

    # --- 입력 오류 ---
    ID_NULL: Final[str] = "[입력 오류] ID를 입력하지 않았습니다."
    PWD_NULL: Final[str] = "[입력 오류] 비밀번호를 입력하지 않았습니다."
    ID_AND_PWD_WRONG: Final[str] = "[입력 오류] ID나 비밀번호를 잘못 입력하였습니다."



# ============================================================
# 사용자 스스로 계정 정지(Soft Delete)
# ============================================================
class LoginSelfBlockMsg:
    """
    계정 사용 정지 요청 시 반환되는 메시지 모음.
    """
    # --- 공통 통신/예외 ---
    PARSING_JSON_FAIL: Final[str] = "[정지 실패] 응답 JSON 파싱 실패."
    FAIL_UNKNOWN: Final[str] = "[정지 실패] 예상치 못한 응답 형식."

    # --- 성공 ---
    SUCCESS: Final[str] = "[계정 정지] 요청하신 계정이 정지되었습니다."

    # --- 비밀번호 오류 ---
    PWD_NULL: Final[str] = "[입력 오류] 비밀번호를 입력하지 않았습니다."
    PWD_WRONG: Final[str] = "[접속 실패] 잘못된 비밀번호."

    

# ============================================================
# 회원가입 관련 메시지
# ============================================================
class LoginSignupMsg:
    """
    회원가입 절차 중 입력 검증·중복검사·서버 응답 등에 사용되는 메시지 모음.
    """
    # --- 공통 ---
    PARSING_JSON_FAIL: Final[str] = "[입력 실패] 응답 JSON 파싱 실패."
    FAIL_UNKNOWN: Final[str] = "[입력 실패] 예상치 못한 응답 형식."
    
    # --- 비밀번호/입력 오류 ---
    PWD_MISSMATCH: Final[str] = "[입력 오류] 비밀번호가 일치하지 않습니다."
    ENTER_TOO_MUCH: Final[str] = "[입력 오류] 값을 하나만 입력하십시오."
    ENTER_NULL: Final[str] = "[입력 오류] 값이 입력되지 않았습니다."
    ENTER_OVER: Final[str] = "[입력 오류] 범위를 벗어나는 값을 입력하였습니다."
    UNIQUE_KEY_ONLY_ONE: Final[str] = "[입력 오류] user_id, ktr_id, email 중 하나를 입력하십시오."

    # --- 개별 필드 검증 ---
    ENTER_TARGET_NULL: Final[str] = "[입력 오류] {k}이(가) 비어있습니다."
    ENTER_TARGET_NOT_PASS: Final[str] = "[입력 오류] {k} 중복 확인이 통과되지 않았습니다."
    ENTER_WRONG_PWD: Final[str] = "[입력 오류] '비밀번호' 형식이 잘못됐습니다."
    ENTER_WRONG_USERNAME: Final[str] = "[입력 오류] '사용자 이름' 형식이 잘못됐습니다."
    
    # --- 입력 패턴 안내 ---
    USER_ID_PAT: Final[str] = "영문/숫자/특수문자(-_) 조합 (4~20자)"
    PWD_PAT: Final[str] = "영문/숫자/특수문자(공백 제외)만 허용 (12~64자)"
    USER_NAME_PAT: Final[str] = "한글/영문/특수문자(-_()) (2~20자)"

    # --- 약관/동의 ---
    PERSONAL_INFO_NOT_AGREE: Final[str] = "개인정보 수집 미동의 시, 회원가입이 제한됩니다."

    # --- 성공 ---
    SUCCESS_ADD: Final[str] = "[계정 생성 성공] 로그인 화면으로 이동하여, 해당 계정으로 접속하십시오."
    SUCCESS_ADD_DEV: Final[str] = "[계정 생성 성공] 개발자 계정은 관리자 승인 후, 사용 가능합니다."



# ============================================================
# 사용자 정보 수정(자기 계정)
# ============================================================
class LoginSelfUpdateMsg:
    """
    회원정보 수정(Self Update) 요청 시 발생 가능한 메시지 모음.
    """
    # --- 공통 ---
    PARSING_JSON_FAIL: Final[str] = "[수정 실패] 응답 JSON 파싱 실패."
    FAIL_UNKNOWN: Final[str] = "[수정 실패] 예상치 못한 응답 형식."

    # --- 비밀번호/입력 오류 ---
    CURRENT_PWD_NULL: Final[str] = "[입력 오류] 현재 비밀번호를 입력하지 않았습니다."
    CURRENT_PWD_WRONG: Final[str] = "[입력 오류] 잘못된 비밀번호를 입력하였습니다."
    PWD_DUPLOCATED: Final[str] = "[입력값 중복] 새로운 비밀번호가 현재 비밀번호와 동일합니다."

    ALL_NULL: Final[str] = "[입력 오류] 모든 값이 미입력 되었습니다. 수정할 값을 하나 이상 입력하십시오."

    EMAIL_CHECK_NEED: Final[str] = "[입력 오류] 이메일 중복 확인이 통과되지 않았습니다."
    EMAIL_WRONG: Final[str] = "[입력 오류] 이메일 형식이 잘못 되었습니다."
    EMAIL_DUPLICATE: Final[str] = "[입력값 중복] 현재 이메일과 동일한 이메일 주소를 입력하였습니다."

    # --- 성공 ---
    SUCCESS: Final[str] = "[수정 성공] 회원 정보가 수정 되었습니다."



# ============================================================
# 관리자 페이지 전용 메시지
# ============================================================
class AdminMsg:
    # --- 공통 ---
    PARSING_JSON_FAIL: Final[str] = "[조회 실패] 응답 JSON 파싱 실패."
    FAIL_UNKNOWN: Final[str] = "[조회 실패] 예상치 못한 응답 형식."
    # 조작 취소
    CANCEL_MODIFY: Final[str] = "[조작 취소] 조작을 취소했습니다."

    # --- 성공 ---
    GET_RECORDS: Final[str] = "[조회 성공] 대상 레코드 반환"
    # 데이터가 없음
    GET_BUT_NO_DATA: Final[str] = "[조회 성공] Table이 비어있음"
    # 다수 대상 조작 성공
    BULK_SUCCESS: Final[str] = "[조작 성공] / 기능: {key} / 방향: {way} / 대상:{target} / 적용: {done} / 미적용: {no_work}"

    # --- 실패 ---
    # 전처리 실패
    DATA_HANDLING_FAIL: Final[str] = "[전처리 실패] {e}"
    # 다수 대상 조작 실패
    BULK_FAIL: Final[str] = "[조작 실패] / 기능: {key} / 방향: {way} / 대상:{target} / 과다적용: {over_work}"
    
    # --- idx 오류로 인한 실패 ---
    # 데이터(index) 미입력
    NO_IDX_ENTER: Final[str] = "[입력 확인] 데이터 조작할 대상이 선택되지 않았습니다."
    # 데이터(index) 과다 입력
    TOO_MUCH_IDX_ENTER: Final[str] = "[입력 확인] 대상을 하나만 선택하십시오."
    # 관리자 수정 방어
    DEFENCE_ADMIN_MODIFY: Final[str] = "[조작 실패] 관리자 계정이 포함되었습니다. 관리자 계정은 해당 페이지에서 수정이 불가합니다."
    # Soft-deleted가 안된 유저를 Hard-delete 하는 경우
    NOT_BLOCKED_USER_DELETE: Final[str] = "[조작 실패] 정지되지 않은 계정의 삭제를 시도했습니다. 삭제는 반드시 정지된 계정만 가능합니다."
    # 정수 변환이 안되는 index 입력 시
    WEIRD_IDX_ENTER: Final[str] = "[입력 확인] idx에 정수 변환이 불가능한 값이 입력되었습니다."

    # --- 비밀번호 ---
    # 문자열이 아닌 값이 입력
    WEIRD_PWD_ENTER: Final[str] = "[입력 확인] 신규 비밀번호에 문자열이 아닌 값이 입력됐습니다."
    # 미입력
    NOT_ENTER_PWD: Final[str] = "[입력 확인] 신규 비밀번호를 입력하지 않았습니다."
    # 잘못된 형식의 비밀번호 입력
    WRONG_FORMAT_PWD: Final[str] = "[입력 확인] 잘못된 형식의 신규 비밀번호를 입력했습니다."


    
class AdminBtns:

    # --- 1. 조회 ---
    DB_SEARCH: Final[str] = "백엔드의 Users table을 조회하여, 관리자 페이지에서 필요로하는 모든 사용자의 정보를 가져옵니다. (사용자 규모가 커지면 추후 변경 예정)"
    SIGNUP_FILTER: Final[str] = '"DB 조회"를 통해 조회된 유저 중, 승인 대기 중인 사용자의 행만 조회합니다.'
    DEVELOPER_FILTER: Final[str] = '"DB 조회"를 통해 조회된 유저 중, 권한이 개발자인 사용자의 행만 조회합니다.'
    ALL_FILTER: Final[str] = '"DB 조회"를 통해 조회된 전체 유저들을 반환합니다.'
    BLOCK_FILTER: Final[str] = '"DB 조회"를 통해 조회된 유저 중, 정지된(Soft-delete) 사용자의 행만 조회합니다.'
    ID_FILTER: Final[str] = '"DB 조회"를 통해 조회된 유저 중, "ID"에 입력된 유저의 계정이 있는 행을 조회합니다(일치).'
    CLEAR_FILTER: Final[str] = "선택되어 있는 index들을 초기 상태로 만듭니다."

    # --- 2. 조작 ---
    SIGNUP_TRUE: Final[str] = "선택된 계정들의 플랫폼 사용을 승인합니다. 승인 시점(signup_at)이 자동 갱신됩니다."
    SIGNUP_FALSE: Final[str] = "선택된 계정들의 플랫폼 사용 승인을 해제합니다. 승인 시점(signup_at)이 None으로 갱신됩니다."

    BLOCK_TRUE: Final[str] = "선택된 계정들을 정지(Soft-delete)합니다. 정지 시점(deleted_at)이 자동 갱신됩니다."
    BLOCK_FALSE: Final[str] = "선택된 계정들의 정지(Soft-delete)를 해제합니다. 정지 시점(deleted_at)이 None으로 갱신됩니다."

    DELETE: Final[str] = "이미 정지되어 있는 계정 중 선택된 계정들을 영구 삭제합니다. 되돌릴 수 없습니다(config에서 비활성화 가능)."

    PASSWORD_CONVERT: Final[str] = "선택된 계정(하나)의 비밀번호를 강제로 변경합니다."



# ============================================================
# 페이지 안내문 / 고정 텍스트
# ============================================================
# --- 관리자 연락처 ---
ADMIN_ADDRESS = """
- E-mail : gooopy123@ktr.or.kr
- Phone1 : 061-370-7852
- Phone2 : 010-2800-8675
"""


# --- 메인 화면 안내문 ---
MAIN_INTRO = f"""
### version: alpha v0.0.1

#### 1. 개요
```
사이드바에서 'Login'을 선택하여 로그인을 진행해주세요
```
* 본 버전은 MVP(최소 기능 제품, Minimum Viable Product) 단계의 알파 테스트 버전입니다.
* 로그인 후, 주요 기능을 사용할 수 있습니다.
* 현재 일부 기능은 개발 중입니다.

* 회원가입은 관리자 승인 없이 가능하나(알파 한정),
  개발자 계정 선택 시에는 관리자 승인 후 이용 가능합니다.

---

#### 2. 주요 기능
* **Login** : 로그인, 회원가입, 회원정보 수정
  - 비밀번호 찾기/이메일 인증은 추후 지원 예정
* **KHA Chat** : LLM 기반 통합 DB 질의 응답
* **FloraGenesis** : 천연물 소재 분석 시스템 - **[구현 예정]**
* **PANCDR** : 항암 약물 반응 예측 시스템 - **[구현 예정]**
* **Dashboard** : 사용자 통계 및 주요 지표 시각화 - **[구현 예정]**
* **Setting** : API Key 신청 등 계정별 설정 (개발자 전용) - **[구현 예정]**
* **Admin** : 관리자 전용 사용자 관리 페이지

---

#### 3. 주의 사항
* 본 서비스는 알파 버전으로, 데이터는 테스트 목적에 한정됩니다.
* 일부 기능은 향후 변경될 수 있습니다.

---

#### 4. 관리자 문의
* KHA alpha 버전은 필수 기능을 제외한 유저 편의 기능 일부가 미구현 상태입니다.
* 사용 시 불편한 사항이나, 에러 접수, KHA의 발전을 위한 아이디어 제안 등은 관리자에게 문의하시기 바랍니다.
```
{ADMIN_ADDRESS}
```

&nbsp;
"""



# --- 비로그인 사용자 안내문 ---
NONE_LOGIN_USER = """
* 로그인하지 않은 계정은 지능형 플랫폼의 기능을 이용할 수 없습니다.
* 로그인 페이지의 **회원가입** 버튼을 눌러 계정을 생성하세요.
"""



# --- 개인정보 수집 동의서 ---
PERSONAL_INFO_AGREE = """
개인정보보호법에 따라 지능형 플랫폼 KHA에 회원가입 신청하시는 분께 수집하는 개인 정보의 항목, 
개인정보의 수집 및 이용목적, 개인정보의 보유 및 이용기간, 동의 거부권 및 동의 거부 시 불이익에 
관한 사항을 안내드리오니 자세히 읽은 후 동의해주시기 바랍니다.

---

### A. 수집하는 개인정보
이용자는 회원가입을 해야만 지능형 플랫폼 KHA에 있는 기능들을 이용할 수 있습니다. KHA 서비스 이용을 
위해 필요한 최소한의 개인정보를 수집합니다.

&nbsp;

#### A-1. 회원가입 시점에 수집하는 개인정보

회원가입 시 필수항목으로 "아이디", "사번", "이메일주소", "비밀번호", "사용자 이름(별명)"을 수집합니다.
* "아이디", "사번", "이메일주소"는 고유한 값으로 중복된 값을 입력할 수 없습니다. 
* "비밀번호"는 암호화되어 서버에 저장되며, 사용자가 입력한 비밀번호 원본은 저장되지 않습니다.
* "사용자 이름(별명)"은 사용자를 표현할 수 있는 임의의 값으로 본명을 의미하지 않습니다.

&nbsp;

#### A-2. 서비스 이용 과정에서 이용자로부터 수집하는 개인정보
서비스 이용 과정에서 이용자에 관한 정보를 자동화된 방법으로 생성하거나 이용자가 입력한 정보를
저장(수집)하거나, 이용자 기기의 고유한 정보를 원래의 값을 확인하지 못 하도록 안전하게 변환하여
수집합니다.

서비스 이용 과정에서 IP 주소, 서비스 이용 기록, 쿠키, 기기정보가 수집될 수 있습니다. 수집된 정보는 
개인정보와의 연계 여부 등에 따라 개인정보에 해당할 수 있고, 개인정보에 해당하지 않을 수도 있습니다.


##### 1. IP 주소
IP 주소는 인터넷 망 사업자가 인터넷에 접속하는 이용자의 PC 등 기기에 부여하는 온라인 주소정보 입니다. 
IP 주소가 개인정보에 해당하는지 여부에 대해서는 각국마다 매우 다양한 견해가 있습니다.

##### 2. 서비스 이용 기록
KHA 접속 일시, 이용한 서비스 목록, 서비스 이용 과정에서 발생하는 정상 또는 비정상 로그 일체, 
챗봇과의 대화 내용 등을 의미합니다. 정보주체가 식별되는 일부 서비스 이용기록(행태정보 포함)과 
관련한 처리 목적 등에 대해서는 본 개인정보 처리방침에서 규정하고 있는 수집하는 개인정보, 수집한 
개인정보의 이용, 개인정보의 파기 등에서 설명하고 있습니다. 이는 서비스 제공을 위해 수반되는 것으로 
이를 거부하시는 경우 서비스 이용에 제한이 있을 수 있으며, 관련하여서는 플랫폼 운영자에게 문의해주시길 
바랍니다. 

##### 3. 기기정보
본 개인정보처리방침에 기재된 기기정보는 생산 및 판매 과정에서 기기에 부여된 정보뿐 아니라, 
기기의 구동을 위해 사용되는 S/W를 통해 확인 가능한 정보를 모두 일컫습니다. OS(Windows, MAC OS 등) 
설치 과정에서 이용자가 PC에 부여하는 컴퓨터의 이름, PC에 장착된 주변기기의 일련번호, 스마트폰의 통신에 
필요한 고유한 식별값(IMEI, IMSI), AAID 혹은 IDFA, 설정언어 및 설정 표준시, USIM의 통신사 코드 
등을 의미합니다. 단, KHA는 IMEI와 같은 기기의 고유한 식별값을 수집할 필요가 있는 경우, 이를 수집하기 
전에 KHA도 원래의 값을 알아볼 수 없는 방식으로 암호화 하여 식별성(Identifiability)을 제거한 후에 
수집합니다.

##### 4. 쿠키(cookie)
쿠키는 이용자가 웹사이트를 접속할 때에 해당 웹사이트에서 이용자의 웹브라우저를 통해 이용자의 PC에 
저장하는 매우 작은 크기의 텍스트 파일입니다. 이후 이용자가 다시 웹사이트를 방문할 경우 웹사이트 
서버는 이용자 PC에 저장된 쿠키의 내용을 읽어 이용자가 설정한 서비스 이용 환경을 유지하여 편리한 
인터넷 서비스 이용을 가능케 합니다. 또한 방문한 서비스 정보, 서비스 접속 시간 및 빈도, 서비스 이용 
과정에서 생성된 또는 제공(입력)한 정보 등을 분석하여 이용자의 취향과 관심에 특화된 서비스(광고 포함)를 
제공할 수 있습니다. 이용자는 쿠키에 대한 선택권을 가지고 있으며, 웹브라우저에서 옵션을 설정함으로써 
모든 쿠키를 허용하거나, 쿠키가 저장될 때마다 확인을 거치거나, 아니면 모든 쿠키의 저장을 거부할 수도 
있습니다. 다만, 쿠키의 저장을 거부할 경우에는 로그인이 필요한 네이버 일부 서비스의 이용에 불편이 
있을 수 있습니다.

**<웹 브라우저에서 쿠키 허용/차단 방법>**
- 크롬(Chrome) : 웹 브라우저 설정 > 개인정보 보호 및 보안 > 인터넷 사용 기록
삭제
- 엣지(Edge) : 웹 브라우저 설정 > 쿠키 및 사이트 권한 > 쿠키 및 사이트 데이터
관리 및 삭제

&nbsp;

&nbsp;

### B. 수집한 개인정보의 이용
KHA의 회원관리, 서비스 개발・제공 및 향상, 안전한 플랫폼 이용환경 구축 등 아래의 목적으로만 개인정보를 
이용합니다.
- 회원 가입 의사의 확인, 이용자 식별, 회원탈퇴 의사의 확인 등 회원관리를 위하여 개인정보를 이용합니다.
- 콘텐츠 등 기존 서비스 제공에 더하여, 서비스 방문 및 이용기록의 분석, 신규 서비스 요소의 발굴 및 기존 
서비스 개선 등을 위하여 개인정보를 이용합니다. 신규 서비스 요소의 발굴 및 기존 서비스 개선 등에는 정보 검색, 
다른 이용자와의 커뮤니케이션, 콘텐츠 생성・제공・추천 등에서의 인공지능(AI) 기술 적용이 포함됩니다.
- 법령 및 KHA 이용약관을 위반하는 회원에 대한 이용 제한 조치, 부정 이용 행위를 포함하여 서비스의 원할한 
운영에 지장을 주는 행위에 대한 방지 및 제재, 계정도용 방지, 약관 개정 등의 고지사항 전달, 분쟁 조정을 위한 
기록 보존, 민원처리 등 이용자 보호 및 서비스 운영을 위하여 개인정보를 이용합니다.
- 서비스 이용기록과 접속 빈도 분석, 서비스 이용에 대한 통계, 서비스 분석 및 통계에 따른 맞춤 서비스 제공 등에 
개인정보를 이용합니다.
- 보안, 프라이버시, 안전 측면에서 이용자가 안심하고 이용할 수 있는 서비스 이용환경 구축을 위해 개인정보를 
이용합니다.

&nbsp;

&nbsp;

### C. 개인정보 보관기간
KHA는 이용자의 "계정 사용 정지" 신청 시, **3년** 동안 개인정보를 안전하게 보관합니다. 보관기간이 만료되는 즉시 
사용자의 모든 정보는 지체없이 파기됩니다.

전자상거래 등에서의 소비자 보호에 관한 법률, 전자문서 및 전자거래 기본법, 통신비밀보호법 등 법령에서 일정기간 
정보의 보관을 규정하는 경우는 아래와 같습니다. 

1. 전자상거래 등에서 소비자 보호에 관한 법률 
* 계약 또는 청약철회 등에 관한 기록: 5년 보관
* 대금결제 및 재화 등의 공급에 관한 기록: 5년 보관
* 소비자의 불만 또는 분쟁처리에 관한 기록: 3년 보관
2. 전자문서 및 전자거래 기본법
* 공인전자주소를 통한 전자문서 유통에 관한 기록: 10년 보관
3. 통신비밀보호법
* 로그인 기록: 3개월

KHA는 별도의 계약, 대금결제 및 재화 등을 공급하지 않으며, 별도의 전자문서를 유통하지 않으므로, "소비자의 불만 
또는 분쟁처리에 관한 기록"을 고려하여, 3년간 개인정보를 보관합니다. KHA는 이 기간 동안 법령의 규정에 따라 
개인정보를 보관하며, 본 정보를 다른 목적으로는 절대 이용하지 않습니다.

&nbsp;

&nbsp;

### D. 개인정보 수집 및 이용 동의를 거부할 권리
이용자는 개인정보의 수집 및 이용 동의를 거부할 권리가 있습니다. 회원가입 시 수집하는 최소한의 
개인정보, 즉 필수 항목에 대한 수집 및 이용 동의를 거부하실 경우, 회원가입이 어려울 수 있습니다.

&nbsp;

&nbsp;
"""


# --- 계정 사용 정지(Soft Delete) 안내문 ---
SOFT_DELETE = """
계정 사용을 정지하시겠습니까?

정지 시, 관리자 요청을 통해서만 재사용이 가능합니다.  
정지된 계정 정보는 3년간 보관 후 자동 폐기됩니다.

정말로 계정을 정지하시겠습니까?
"""


# --- 비밀번호 분실 안내문 ---
LOST_PASSWORD = f"""
* 이메일 인증을 통한 비밀번호 재생성은 현재 구현되지 않았습니다.
> 추후 구현 예정
* 관리자에게 문의하여 초기화된 비밀번호를 전달받기 바랍니다.
```
{ADMIN_ADDRESS}
```
"""


# --- 비 관리자 사용자 안내문 ---
NO_ADMIN_USER = f"""
* 해당 페이지는 관리자 권한이 있는 유저를 위한 페이지입니다.
* 관리자 계정이 아니라면 해당 페이지 사용이 불가합니다.
* 관리자에 대한 문의 사항이 있는 경우 다음 연락처로 문의 주십
시오.
```
{ADMIN_ADDRESS}
```
"""


